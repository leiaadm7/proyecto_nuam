{% extends 'calificaciones/base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 style="color: #001A4B;">Calificaciones Tributarias</h2>

    <div class="d-flex gap-2">

        <a href="{% url 'carga_masiva' %}" class="btn btn-outline-primary">
            Carga Masiva CSV
        </a>

        <a href="{% url 'historial' %}" class="btn btn-outline-secondary">
            Historial de Auditoría
        </a>

        <a href="{% url 'nuevo' %}" class="btn btn-nuam">
            + Nuevo Registro
        </a>
    </div>
</div>

<div class="card p-0 overflow-hidden">
    <table class="table table-hover mb-0">
        <thead>
            <tr>
                <th>País</th>
                <th>Tipo Impuesto</th>
                <th>Monto Base</th>
                <th>Factor</th>
                <th>Analista</th>
                <th>Fecha</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for c in registros %}
            <tr>
                <td><strong>{{ c.get_pais_display }}</strong></td>
                <td>{{ c.get_tipo_display }}</td>
                <td>USD {{ c.monto_base }}</td>
                <td>{{ c.factor }}</td>
                <td><span class="badge bg-secondary">{{ c.analista.username }}</span></td>
                <td>{{ c.fecha_registro|date:"d/m/Y H:i" }}</td>
                <td>
                    <a href="{% url 'editar' c.id %}" class="btn btn-sm btn-outline-primary">Editar</a>
                    <a href="{% url 'eliminar' c.id %}" class="btn btn-sm btn-outline-danger"
                       onclick="return confirm('¿Estás seguro de eliminar este registro?')">Eliminar</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7" class="text-center p-4">No hay datos registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
